/*!
 DMXzone Preloader
 Version: 2.0.0-beta.2
 (c) 2023 Wappler.io
 @build 2023-05-26 11:24:45
 */
dmx.Component("preloader",{attributes:{preview:{type:Boolean,default:!1},color:{type:String,default:"#333"},bgcolor:{type:String,default:"#fff"},size:{type:Number,default:60},spinner:{type:String,default:""}},methods:{show(){this._show()},hide(){this._hide()}},init(e){this._checkLoaded=this._checkLoaded.bind(this),this._documentLoaded=!1,this._imagesLoaded=!1,this._dataLoaded=!1,this._spinners={rotatingPlane:0,doubleBounce:2,wave:5,wanderingCubes:2,pulse:0,chasingDots:2,threeBounce:3,circle:12,cubeGrid:9,fadingCircle:12,foldingCube:4},document.addEventListener("readystatechange",this._checkLoaded),requestAnimationFrame((()=>{this._checkLoaded()}))},destroy(){document.removeEventListener("readystatechange",this._checkLoaded)},render(e){const{color:t,bgcolor:o,size:s,spinner:d}=this.props;e.classList.add("dmxPreloader"),e.style.setProperty("--color",t),e.style.setProperty("--bgcolor",o),e.style.setProperty("--size",s+"px"),d&&(e.innerHTML=`\n        <div class="dmxPreloader-spinner dmxPreloader-${d}>\n          ${Array.from({length:this._spinners[d]}).map((()=>"\n            <div></div>\n          ")).join("")}\n        <div>\n      `),this._show()},performUpdate(e){e.has("color")&&this.$node.style.setProperty("--color",this.props.color),e.has("bgcolor")&&this.$node.style.setProperty("--bgcolor",this.props.bgcolor),e.has("size")&&this.$node.style.setProperty("--size",this.props.size+"px")},_show(){this.$node.style.removeProperty("opacity"),this.$node.style.removeProperty("z-index"),document.body.style.setProperty("overflow","hidden")},_hide(){this.$node.style.setProperty("opacity",0),this.$node.style.setProperty("z-index",-1),document.body.style.removeProperty("overflow")},_checkLoaded(){this.props.preview||(this._checkDocumentLoaded(),this._checkImagesLoaded(),this._checkDataLoaded(),this._documentLoaded&&this._imagesLoaded&&this._dataLoaded&&this._hide())},_checkDocumentLoaded(){this._documentLoaded="complete"===document.readyState},_checkImagesLoaded(){this._imagesLoaded=Array.from(document.getElementsByTagName("img")).every((e=>{if(e.complete)return!0;if(!e.isListening){const t=new Image;t.addEventListener("load",(()=>this._checkLoaded())),t.addEventListener("error",(()=>this._checkLoaded())),t.src=e.src,e.isListening=!0}return!1}))},_checkDataLoaded(){this._dataLoaded=this._dataComponents().every((e=>e.props.noload||null!=e.data||e._xhr&&4===e._xhr.readyState))},_dataComponents(){const e=[];return dmx.app.children.forEach((function t(o){o instanceof dmx.Component("fetch")&&e.push(o),o.children.forEach(t)})),e}});
//# sourceMappingURL=../maps/dmxPreloader.js.map
