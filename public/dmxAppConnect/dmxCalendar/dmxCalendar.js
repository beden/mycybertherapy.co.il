/*!
 App Connect Calendar
 Version: 1.1.5
 (c) 2023 Wappler.io
 @build 2023-04-12 10:03:45
 */
dmx.Component("calendar",{initialData:{title:null,activeStart:null,activeEnd:null,currentStart:null,currentEnd:null},constructor:function(e,t){this.onDatesRender=this.onDatesRender.bind(this),this.onDateClick=this.onDateClick.bind(this),this.onEventClick=this.onEventClick.bind(this),this.onEventMouseEnter=this.onEventMouseEnter.bind(this),this.onEventMouseLeave=this.onEventMouseLeave.bind(this),this.onEventDrop=this.onEventDrop.bind(this),this.onEventResize=this.onEventResize.bind(this),this.onEventRender=this.onEventRender.bind(this),this.onEventDestroy=this.onEventDestroy.bind(this),this.onSelect=this.onSelect.bind(this),this.parseSource=this.parseSource.bind(this),this._businessHours={},dmx.BaseComponent.call(this,e,t)},attributes:{timezone:{type:String,default:"local"},date:{type:String,default:null},locale:{type:String,default:null},height:{type:String,default:null},"aspect-ratio":{type:Number,default:1.35},view:{type:String,default:null},views:{type:Array,default:[]},theme:{type:String,default:"standard"},"hide-non-current-dates":{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},editable:{type:Boolean,default:null},"no-event-overlap":{type:Boolean,default:!1},"business-hours":{type:Boolean,default:!1},"google-calendar-api-key":{type:String,default:null},"no-fixed-week-count":{type:Boolean,default:!1},"event-order":{type:String,default:"start,-duration,allDay,title"},"event-limit":{type:[Boolean,Number],default:!1},"now-indicator":{type:Boolean,default:!1},"bs4-tooltip":{type:Boolean,default:!1},"bs4-tooltip-placement":{type:String,default:'"top"'},"bs4-tooltip-title":{type:String,default:"event.extendedProps.description || event.title"},"bs4-tooltip-html":{type:String,default:"false"},"views-options":{type:Object,default:{}}},methods:{gotoDate:function(e){this.calendar.gotoDate(e)},updateSize:function(){this.calendar.updateSize()},prev:function(){this.calendar.prev()},next:function(){this.calendar.next()},prevYear:function(){this.calendar.prevYear()},nextYear:function(){this.calendar.nextYear()},today:function(){this.calendar.today()}},events:{dateclick:MouseEvent,eventclick:MouseEvent,eventmouseenter:MouseEvent,eventmouseleave:MouseEvent,eventdrop:Event,eventresize:Event,select:Event},onDatesRender:function(e){this.set({title:e.view.title,activeStart:this.parseDate(e.view.activeStart),activeEnd:this.parseDate(e.view.activeEnd),currentStart:this.parseDate(e.view.currentStart),currentEnd:this.parseDate(e.view.currentEnd)})},onDateClick:function(e){!this.dispatchEvent("dateclick",e.jsEvent,{date:e.dateStr,allDay:e.allDay})&&e.jsEvent.preventDefault()},onEventClick:function(e){!this.dispatchEvent("eventclick",e.jsEvent,{event:this.getEventProps(e.event)})&&e.jsEvent.preventDefault()},onEventMouseEnter:function(e){this.dispatchEvent("eventmouseenter",e.jsEvent,{event:this.getEventProps(e.event)})},onEventMouseLeave:function(e){this.dispatchEvent("eventmouseleave",e.jsEvent,{event:this.getEventProps(e.event)})},onEventDrop:function(e){this.dispatchEvent("eventdrop",e.jsEvent,{event:this.getEventProps(e.event)})},onEventResize:function(e){this.dispatchEvent("eventresize",e.jsEvent,{event:this.getEventProps(e.event)})},onEventRender:function(e){var t=new dmx.DataScope({event:this.getEventProps(e.event)},this);e.event.source&&e.event.source.internalEventSource.extendedProps&&e.event.source.internalEventSource.extendedProps.bs4Tooltip?$(e.el).tooltip({placement:dmx.parse(e.event.source.internalEventSource.extendedProps.bs4TooltipPlacement,t)||"top",title:dmx.parse(e.event.source.internalEventSource.extendedProps.bs4TooltipTitle,t)||""}):this.props["bs4-tooltip"]&&$(e.el).tooltip({placement:dmx.parse(this.props["bs4-tooltip-placement"],t)||"top",title:dmx.parse(this.props["bs4-tooltip-title"],t)||"",html:Boolean(dmx.parse(this.props["bs4-tooltip-html"],t))})},onEventDestroy:function(e){this.props["bs4-tooltip"]&&$(e.el).tooltip("dispose")},onSelect:function(e){this.dispatchEvent("select",e.jsEvent,{start:e.startStr,end:e.endStr,allDay:e.allDay})},parseSource:function(e){e instanceof dmx.Component("calendar-source-base")&&(e.calendar=this.calendar,e.register())},$parseAttributes:function(e){var t=this;dmx.BaseComponent.prototype.$parseAttributes.call(this,e),dmx.dom.getAttributes(e).forEach((function(e){"business-hours"==e.name&&t.$addBinding(e.value,(function(n){if(null!=n){var s=dmx.clone(t.props),i=Object.keys(e.modifiers)[0];t._businessHours[i]=n,Array.isArray(this.props["business-hours"])||(t.props["business-hours"]=[]),t.props["business-hours"]=Object.values(t._businessHours),t.update(s)}}))})),this.parseAttribute(e,"views-options").forEach((function(e){t.$addBinding(e.value,(function(n){var s=dmx.clone(t.props);t.props["views-options"][this.toCamelCase(e.argument)]=n||{},t.update(s)}))})),this.parseAttribute(e,"constraint").forEach((function(n){n.modifiers["business-hours"]?t.props.constraint="businessHours":n.binding?t.$addBinding(n.value,(function(e){var n=dmx.clone(t.props);t.props.constraint=e,t.update(n)})):t.props.constraint=n.value,e.removeAttribute(n.fullName)}))},render:function(e){var t=["interaction","dayGrid","timeGrid","list","bootstrap","googleCalendar"].filter((function(e){return!!window["FullCalendar"+e[0].toUpperCase()+e.slice(1)]}));this.calendar=new FullCalendar.Calendar(e,{plugins:t,googleCalendarApiKey:this.props["google-calendar-api-key"],timeZone:this.props.timezone,defaultDate:this.props.date,defaultView:this.props.view,locale:this.props.locale,height:this.props.height,aspectRatio:this.props["aspect-ratio"],themeSystem:this.props.theme,selectable:this.props.selectable,selectConstraint:this.props.constraint,editable:this.props.editable,showNonCurrentDates:!this.props["hide-non-current-dates"],eventOverlap:!this.props["no-event-overlap"],businessHours:this.props["business-hours"],fixedWeekCount:!this.props["no-fixed-week-count"],eventOrder:this.props["event-order"],eventLimit:this.props["event-limit"],nowIndicator:this.props["now-indicator"],datesRender:this.onDatesRender,dateClick:this.onDateClick,eventClick:this.onEventClick,eventMouseEnter:this.onEventMouseEnter,eventMouseLeave:this.onEventMouseLeave,eventDrop:this.onEventDrop,eventResize:this.onEventResize,eventRender:this.onEventRender,eventDestroy:this.onEventDestroy,select:this.onSelect,views:this.props["views-options"],header:{left:"today prev,next",center:"title",right:this.props.views.toString()}}),this.$parse(),this.calendar.render()},update:function(e){this.calendar&&(e.view!=this.props.view&&this.calendar.changeView(this.props.view||"dayGridMonth"),e.date!=this.props.date&&this.calendar.gotoDate(this.props.date),e.timezone!=this.props.timezone&&this.calendar.setOption("timeZone",this.props.timezone),e.locale!=this.props.locale&&this.calendar.setOption("locale",this.props.locale),e.theme!=this.props.theme&&this.calendar.setOption("themeSystem",this.props.theme),e["hide-non-current-dates"]!=this.props["hide-non-current-dates"]&&this.calendar.setOption("showNonCurrentDates",!this.props["hide-non-current-dates"]),e.selectable!=this.props.selectable&&this.calendar.setOption("selectable",this.props.selectable),e.editable!=this.props.editable&&this.calendar.setOption("editable",this.props.editable),e["no-event-overlap"]!=this.props["no-event-overlap"]&&this.calendar.setOption("eventOverlap",!this.props["no-event-overlap"]),dmx.equal(e["business-hours"],this.props["business-hours"])||this.calendar.setOption("businessHours",this.props["business-hours"]),dmx.equal(e.constraint,this.props.constraint)||this.calendar.setOption("selectConstraint",this.props.constraint),e["google-calendar-api-key"]!=this.props["google-calendar-api-key"]&&this.calendar.setOption("googleCalendarApiKey",this.props["google-calendar-api-key"]),e["no-fixed-week-count"]!=this.props["no-fixed-week-count"]&&this.calendar.setOption("fixedWeekCount",!this.props["no-fixed-week-count"]),e["event-order"]!=this.props["event-order"]&&this.calendar.setOption("eventOrder",this.props["event-order"]),e["event-limit"]!=this.props["event-limit"]&&this.calendar.setOption("eventLimit",this.props["event-limit"]),e["now-indicator"]!=this.props["now-indicator"]&&this.calendar.setOption("nowIndicator",this.props["now-indicator"]),dmx.equal(e["views-options"],this.props["views-options"])||this.calendar.setOption("views",this.props["views-options"]))},beforeDestroy:function(){this.calendar.destroy()},getEventProps:function(e){return{id:e.id,start:e.start&&e.start.toISOString(),end:e.end&&e.end.toISOString(),allDay:e.allDay,title:e.title,extendedProps:e.extendedProps}},parseAttribute:function(e,t){var n=[],s=new RegExp("^(dmx\\-bind:)?"+t.replace(/[-[\]{}()*+?.,\^$|#\s]/g,"\\$&"),"i");if(1==e.nodeType)for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i];if(r&&r.specified&&s.test(r.name)){var o=r.name,a=null,l={};(o=o.replace(/^dmx\-bind:/i,"")).split(".").forEach((function(e,t){if(0===t)o=e;else{var n=e.indexOf(":");n>0?l[e.substr(0,n)]=e.substr(n+1):l[e]=!0}}));var p=o.indexOf(":");p>0&&(a=o.substr(p+1),o=o.substr(0,p)),n.push({name:o,binding:0===r.name.indexOf("dmx-bind:"),fullName:r.name,value:r.value,argument:a,modifiers:l})}}return n},parseDate:function(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)+" 00:00:00"},toCamelCase:function(e){return e.replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}))}}),dmx.Component("calendar-source-base",{constructor:function(e,t,n){t instanceof dmx.Component("calendar")?this.calendar=t.calendar:console.error("calendar-source can only be child of calendar component."),dmx.BaseComponent.call(this,e,t)},initialData:{id:null,events:[]},attributes:{color:{type:String,default:null},"background-color":{type:String,default:null},"border-color":{type:String,default:null},"text-color":{type:String,default:null},"class-name":{type:String,default:null},editable:{type:Boolean,default:null},overlap:{type:Boolean,default:!1},"bs4-tooltip":{type:Boolean,default:!1},"bs4-tooltip-placement":{type:String,default:'"top"'},"bs4-tooltip-title":{type:String,default:"event.extendedProps.description || event.title"},"bs4-tooltip-html":{type:String,default:"false"}},methods:{refetch:function(){this.refetch()}},render:function(){this.calendar&&(this.$parse(),this.set("id",this.name))},refetch:function(){this.calendar.getEventSourceById(this.name).refetch()},toCamelCase:function(e){return e.replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}))}}),dmx.Component("calendar-source",{extends:"calendar-source-base",constructor:function(e,t,n){this.parseEvents=this.parseEvents.bind(this),dmx.Component("calendar-source-base").call(this,e,t)},attributes:{events:{type:Array,default:[]},"event-id":{type:String,default:"id"},"event-title":{type:String,default:"title"},"event-url":{type:String,default:"url"},"event-start":{type:String,default:"start"},"event-end":{type:String,default:"end"},"event-all-day":{type:String,default:"allDay"},"event-days-of-week":{type:String,default:"daysOfWeek"},"event-start-time":{type:String,default:"startTime"},"event-end-time":{type:String,default:"endTime"},"event-start-recur":{type:String,default:"startRecur"},"event-end-recur":{type:String,default:"endRecur"},"event-group-id":{type:String,default:"groupId"},"event-rendering":{type:String,default:"rendering"},"event-color":{type:String,default:"color"},"event-background-color":{type:String,default:"backgroundColor"},"event-border-color":{type:String,default:"borderColor"},"event-text-color":{type:String,default:"textColor"},"event-class-name":{type:String,default:"className"},"event-editable":{type:String,default:"editable"},"event-overlap":{type:String,default:"overlap"},"event-extended-props":{type:String,default:"$value"}},parseEvents:function(e,t,n){this.events=[],Array.isArray(this.props.events)&&dmx.repeatItems(this.props.events).forEach((function(e){var t=new dmx.DataScope(e,this),n={};for(var s in this.props)if(this.props.hasOwnProperty(s)&&0===s.indexOf("event-")){var i=dmx.parse(this.props[s],t);null!=i&&(n[this.toCamelCase(s.substr(6))]=i)}this.events.push(n)}),this),this.children.forEach((function(e){if(e instanceof dmx.Component("calendar-event")){var t={id:e.name};for(var n in e.props)e.props.hasOwnProperty(n)&&null!=e.props[n]&&(t[this.toCamelCase(n)]=e.props[n]);this.events.push(t)}}),this),t(this.events),this.set("events",this.events)},render:function(){if(this.calendar){this.$parse();var e={};for(var t in this.props)this.props.hasOwnProperty(t)&&null!=this.props[t]&&(e[this.toCamelCase(t)]=this.props[t]);this.calendar.addEventSource(Object.assign({id:this.name},e,{events:this.parseEvents})),this.set("id",this.name)}},update:function(e){dmx.equal(e.events,this.props.events)||this.refetch()}}),dmx.Component("calendar-source-google",{extends:"calendar-source-base",constructor:function(e,t,n){this.onSuccess=this.onSuccess.bind(this),this.onFailure=this.onFailure.bind(this),dmx.Component("calendar-source-base").call(this,e,t)},attributes:{"google-calendar-api-key":{type:String,default:null},"google-calendar-id":{type:String,default:null}},events:{success:Event,failure:Event},onSuccess:function(){this.dispatchEvent("success")},onFailure:function(e){this.dispatchEvent("failure")},render:function(){if(this.calendar){this.$parse();var e={};for(var t in this.props)this.props.hasOwnProperty(t)&&null!=this.props[t]&&(e[this.toCamelCase(t)]=this.props[t]);this.calendar.addEventSource(Object.assign({id:this.name,success:this.onSuccess,failure:this.onFailure},e)),this.set("id",this.name)}}}),dmx.Component("calendar-event",{constructor:function(e,t,n){t instanceof dmx.Component("calendar-source")||console.error("calendar-event can only be child of calendar-source component."),dmx.BaseComponent.call(this,e,t)},attributes:{title:{type:String,default:null},url:{type:String,default:null},start:{type:String,default:null},end:{type:String,default:null},"all-day":{type:Boolean,default:!1},"days-of-week":{type:Array,default:null},"start-time":{type:String,default:null},"end-time":{type:String,default:null},"start-recur":{type:String,default:null},"end-recur":{type:String,default:null},"group-id":{type:String,default:null},rendering:{type:String,default:null},editable:{type:Boolean,default:null},color:{type:String,default:null},"background-color":{type:String,default:null},"border-color":{type:String,default:null},"text-color":{type:String,default:null},"class-name":{type:String,default:null},"extended-props":{type:Object,default:null}},$parseAttributes:function(e){var t=this;dmx.BaseComponent.prototype.$parseAttributes.call(this,e),this.parseAttribute(e,"constraint").forEach((function(n){n.modifiers["business-hours"]?t.props.constraint="businessHours":n.binding?t.$addBinding(n.value,(function(e){t.props.constraint=e})):t.props.constraint=n.value,e.removeAttribute(n.fullName)}))},update:function(e){dmx.equal(e,this.props)||this.parent.refetch&&this.parent.refetch()},parseAttribute:function(e,t){var n=[],s=new RegExp("^(dmx\\-bind:)?"+t.replace(/[-[\]{}()*+?.,\^$|#\s]/g,"\\$&"),"i");if(1==e.nodeType)for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i];if(r&&r.specified&&s.test(r.name)){var o=r.name,a=null,l={};(o=o.replace(/^dmx\-bind:/i,"")).split(".").forEach((function(e,t){if(0===t)o=e;else{var n=e.indexOf(":");n>0?l[e.substr(0,n)]=e.substr(n+1):l[e]=!0}}));var p=o.indexOf(":");p>0&&(a=o.substr(p+1),o=o.substr(0,p)),n.push({name:o,binding:0===r.name.indexOf("dmx-bind:"),fullName:r.name,value:r.value,argument:a,modifiers:l})}}return n}});
//# sourceMappingURL=../maps/dmxCalendar.js.map
